<!doctype html>
<html lang="id">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Apersepsi • Single Application</title>

    <!-- Bootstrap & Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

    <style>
        :root {
            --navbar-h: 55px;
            --footer-h: 40px;
            --brand: #ff3f8e;
            --sidebar-w: 255px;
            --sidebar-gap: 8px;
            --line: #e5e7eb;
        }

        html,
        body {
            height: 100%;
        }

        body {
            padding-bottom: var(--footer-h);
            background: #fff;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        }

        .main-pad {
            padding-top: var(--navbar-h);
        }

        main.app-shell {
            min-height: calc(100vh - var(--navbar-h) - var(--footer-h));
        }

        .navbar,
        .footer {
            background: #fff;
        }

        .footer {
            border-top: 1px solid #eee;
        }

        .menu-card {
            background: #fff;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, .04);
        }

        .menu-title {
            padding: .75rem 1rem;
            border-bottom: 1px solid #eee;
            font-weight: 600;
        }

        .menu-item {
            display: block;
            padding: .6rem 1rem;
            color: inherit;
            text-decoration: none;
            font-size: .95rem;
        }

        .menu-item:hover {
            background: #fafafa;
        }

        .menu-item.active {
            background: #f5f5f5;
            font-weight: 600;
        }

        .no-top-gap>aside,
        .no-top-gap>section {
            padding-top: 0 !important;
        }

        .btn-brand {
            background: var(--brand);
            color: #fff;
        }

        .btn-brand:hover {
            color: #fff;
            filter: brightness(.95);
        }

        .materi-card .card-header {
            background: #fff;
            border-bottom: 1px solid #eee;
            padding: .5rem 1rem;
        }

        .page-nav {
            margin-top: 1rem;
            margin-bottom: 0.5rem;
        }

        .page-nav-inner {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: .5rem;
            flex-wrap: wrap;
        }

        /* Mobile: sidebar ikut alur */
        @media (max-width: 767.98px) {
            .sidebar-fixed {
                position: static;
                width: 100%;
            }
        }

        /* Desktop: sidebar fixed kiri, konten bergeser & card dipendekkan */
        @media (min-width: 768px) {
            .sidebar-fixed {
                position: fixed;
                top: var(--navbar-h);
                left: 0;
                width: var(--sidebar-w);
                height: calc(100dvh - var(--navbar-h));
                overflow-y: auto;
            }

            .content-with-fixed {
                margin-left: calc(var(--sidebar-w) + var(--sidebar-gap));
            }

            .materi-card {
                display: flex;
                flex-direction: column;
                max-height: calc(100dvh - var(--navbar-h) - var(--footer-h) - 90px);
            }

            .materi-card .card-body {
                flex: 1 1 auto;
                min-height: 0;
                overflow: auto;
                -webkit-overflow-scrolling: touch;
            }
        }

        .flashcard {
            border: 1px solid var(--line);
            border-radius: 8px;
            padding: .75rem;
            cursor: pointer;
            background: #fff;
            transition: background .15s, box-shadow .15s;
        }

        .flashcard.active {
            background: rgba(255, 63, 142, 0.04);
            box-shadow: 0 0 0 1px rgba(255, 63, 142, 0.25);
        }

        .box {
            fill: #fff;
            stroke: #e5e7eb;
            stroke-width: 2;
            rx: 16;
        }

        .line {
            stroke: var(--brand);
            stroke-width: 3;
        }

        .text {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            font-size: 18px;
        }

        .card-section {
            border-left: 4px solid var(--brand);
            background: #ffffff;
        }

        .badge-step {
            font-size: .7rem;
            text-transform: uppercase;
            letter-spacing: .08em;
            background: var(--brand);
        }

        .btn-brand {
            background: var(--brand);
            border-color: var(--brand);
            color: #fff;
        }

        .btn-brand:hover {
            filter: brightness(.95);
            color: #fff;
        }

        .btn-outline-brand {
            border-color: var(--brand);
            color: var(--brand);
        }

        .btn-outline-brand:hover {
            background: var(--brand);
            color: #fff;
        }

        .btn-row {
            display: flex;
            gap: .5rem;
            justify-content: flex-end;
            margin-top: .5rem;
        }

        .tiny-label {
            font-size: .8rem;
            color: #6b7280;
        }

        textarea.form-control {
            background: #fff;
        }
    </style>
</head>

<body>
    <!-- NAVBAR -->
    <nav class="navbar navbar-light navbar-expand-lg fixed-top shadow-sm">
        <div class="container">
            <a class="navbar-brand d-flex align-items-center gap-2" href="../index.html">
                <i class="bi bi-brush" style="font-size:1.25rem; color:var(--brand)"></i>
                <strong>Pewarnaan Rambut</strong> <span class="fw-normal">• Single Application</span>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navs">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navs">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="../index.html">Beranda</a></li>
                    <li class="nav-item"><a class="nav-link active fw-semibold" style="color:var(--brand)"
                            aria-current="page" href="videopengantar.html">Materi</a></li>
                    <li class="nav-item"><a class="nav-link" href="../evaluasi.html">Latihan</a></li>
                    <li class="nav-item"><a class="nav-link" href="../kd.html">Tujuan Pembelajaran</a></li>
                    <li class="nav-item"><a class="nav-link" href="../peta.html">Peta Konsep</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- MAIN: sidebar + konten -->
    <main class="main-pad app-shell">
        <div class="container-fluid">
            <div class="row g-1 no-top-gap">
                <!-- SIDEBAR -->
                <aside class="col-12 col-md-auto order-1 order-md-0 p-0">
                    <nav class="menu-card sidebar-fixed shadow-sm">
                        <div class="menu-title"><i class="bi bi-journal-bookmark"></i> Single Application</div>
                        <a class="menu-item " aria-current="page" href="videopengantar.html">
                            <i class="bi bi-lightbulb">Video Pengantar</i>
                        </a>
                        <a class="menu-item" aria-current="page" href="SingleApplication.html">
                            <i class="bi bi-lightbulb"></i> Overview Single Application
                        </a>

                        <!-- A. Pewarnaan Rambut Single -->
                        <button class="d-flex align-items-center w-100 border-0 bg-transparent menu-item" type="button"
                            data-bs-toggle="collapse" data-bs-target="#submenu-A" aria-expanded="true"
                            aria-controls="submenu-A">
                            <span class="me-2"><i class="bi bi-droplet-half"></i></span>
                            <span class="flex-grow-1 text-start">A. Pewarnaan Rambut Single</span>
                            <i class="bi bi-chevron-down small"></i>
                        </button>
                        <div class="collapse show" id="submenu-A">
                            <ul class="nav flex-column ps-4 my-1">
                                <li><a class="menu-item py-1" href="PewarnaanSingleApplication.html">1. Pewarnaan Single
                                        Application</a></li>
                                <li><a class="menu-item py-1" href="CaraMemilihWarna.html">2. Cara Memilih Warna</a>
                                </li>
                                <li><a class="menu-item py-1" href="MemilihWarnaCat.html">3. Memilih Warna Cat</a></li>
                                <li><a class="menu-item py-1" href="KontraindikasiPewarnaan.html">4. Kontraindikasi
                                        Pewarnaan</a></li>
                                <li><a class="menu-item py-1 active" href="HalYangDiperhatikan.html">5. Hal
                                        Diperhatikan</a>
                                </li>
                                <li><a class="menu-item py-1" href="AyoLakukanA.html">6. Ayo Lakukan</a></li>
                            </ul>
                        </div>

                        <!-- B. Toning -->
                        <button class="d-flex align-items-center w-100 border-0 bg-transparent menu-item" type="button"
                            data-bs-toggle="collapse" data-bs-target="#submenu-B" aria-expanded="true"
                            aria-controls="submenu-B">
                            <span class="me-2"><i class="bi bi-palette"></i></span>
                            <span class="flex-grow-1 text-start">B. Toning</span>
                            <i class="bi bi-chevron-down small"></i>
                        </button>
                        <div class="collapse show" id="submenu-B">
                            <ul class="nav flex-column ps-4 my-1">
                                <li><a class="menu-item py-1" href="HairToning.html">1. Hair Toning</a></li>
                                <li><a class="menu-item py-1" href="CiriHairToning.html">2. Ciri Hair Toning</a></li>
                                <li><a class="menu-item py-1" href="KeunggulanHairToning.html">3. Keunggulan Hair
                                        Toning</a></li>
                                <li><a class="menu-item py-1" href="KosmetikHairToning.html">4. Kosmetik Hair Toning</a>
                                </li>
                                <li><a class="menu-item py-1" href="ProsedurToning.html">5. Prosedur Melakukan
                                        Toning</a></li>
                                <li><a class="menu-item py-1 active" href="HalDiperhatikanToning.html">6. Hal
                                        Diperhatikan</a>
                                </li>
                                <li><a class="menu-item py-1" href="AyoLakukanB.html">7. Ayo Lakukan</a></li>
                            </ul>
                        </div>

                        <!-- C. Pewarnaan Uban -->
                        <button class="d-flex align-items-center w-100 border-0 bg-transparent menu-item" type="button"
                            data-bs-toggle="collapse" data-bs-target="#submenu-C" aria-expanded="true"
                            aria-controls="submenu-C">
                            <span class="me-2"><i class="bi bi-person-lines-fill"></i></span>
                            <span class="flex-grow-1 text-start">C. Pewarnaan Uban</span>
                            <i class="bi bi-chevron-down small"></i>
                        </button>
                        <div class="collapse show" id="submenu-C">
                            <ul class="nav flex-column ps-4 my-1">
                                <li><a class="menu-item py-1" href="PewarnaanUban.html">1. Pewarnaan Uban</a></li>
                                <li><a class="menu-item py-1" href="JenisPewarnaanUban.html">2. Jenis Pewarnaan</a>
                                </li>
                                <li><a class="menu-item py-1" href="TeknikPewarnaanUban.html">3. Teknik Pewarnaan</a>
                                </li>
                                <li><a class="menu-item py-1" href="UjiTempel.html">4. Uji Tempel</a></li>
                                <li><a class="menu-item py-1" href="ProsedurKerjaUban.html">5. Prosedur Kerja</a></li>
                                <li><a class="menu-item py-1" href="ReaksiAlergiUban.html">6. Reaksi Alergi</a></li>
                                <li><a class="menu-item py-1" href="KesalahanPewarnaanUban.html">7. Kesalahan
                                        Pewarnaan</a></li>
                                <li><a class="menu-item py-1" href="AyoLakukanC.html">8. Ayo Lakukan</a></li>
                            </ul>
                        </div>

                        <!-- Evaluasi -->
                        <a class="menu-item" href="../evaluasi.html">
                            <i class="bi bi-clipboard-check"></i> Evaluasi
                        </a>
                        <a class="menu-item" href="VideoPentup.html">
                            <i class="bi bi-camera-video"></i> Evaluasi
                        </a>
                    </nav>
                </aside>

                <!-- KONTEN KANAN -->
                <section class="col-12 col-md-9 col-xl-10 content-with-fixed order-2 order-md-0">
                    <div class="card shadow-sm materi-card">
                        <div class="card-header d-flex align-items-center gap-2">
                            <i class="bi bi-lightbulb" style="color:var(--brand); font-size:1.25rem;"></i>
                            <h3 class="h5 mb-0 fw-bold">Hal-Hal yang Harus Diperhatikan sebelum Mewarnai Rambut Teknik
                                Single Application
                        </div>

                        <div class="card-body" id="apersepsi-hair-coloring">

                            <h1 class="h4 mb-1">5. Hal-Hal yang Harus Diperhatikan sebelum Mewarnai Rambut Teknik
                                Single Application</h1>
                            <p class="text-secondary mb-0">
                                Empat poin penting: konsultasi, pemilihan produk, perawatan rambut, dan mengikuti
                                petunjuk penggunaan.
                                Di bawah ini kamu bisa berlatih sekaligus menyimpan jawaban di <strong>local
                                    storage</strong> perangkatmu.
                            </p>

                            <!-- MATERI + INTERAKTIF -->
                            <section id="materi" class="mb-4">
                                <div class="row g-3">

                                    <!-- a. Konsultasi -->
                                    <div class="col-12">
                                        <div class="card card-section shadow-sm">
                                            <div class="card-body">
                                                <span class="badge badge-step text-white mb-1">Poin a</span>
                                                <h2 class="h6 mt-1">Konsultasi dengan Stylist / Profesional</h2>
                                                <p class="mb-2">
                                                    Melakukan konsultasi sebelum pewarnaan rambut dengan stylist atau
                                                    profesional kecantikan
                                                    untuk mendiskusikan kondisi rambut dan kulit kepala.
                                                </p>

                                                <p class="tiny-label mb-1">Latihan a – Kapan sebaiknya konsultasi
                                                    dilakukan?</p>
                                                <select id="qa" class="form-select form-select-sm w-auto">
                                                    <option value="">-- pilih jawaban --</option>
                                                    <option value="sebelum">Sebelum melakukan pewarnaan rambut</option>
                                                    <option value="sesudah">Sesudah pewarnaan selesai</option>
                                                    <option value="tidakperlu">Tidak perlu konsultasi</option>
                                                </select>
                                                <div id="feedA" class="mt-2 small"></div>
                                                <div class="btn-row">
                                                    <button class="btn btn-outline-brand btn-sm"
                                                        onclick="cekA()">Cek</button>
                                                    <button class="btn btn-outline-secondary btn-sm"
                                                        onclick="resetA()">Reset</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- b. Produk aman -->
                                    <div class="col-12">
                                        <div class="card card-section shadow-sm">
                                            <div class="card-body">
                                                <span class="badge badge-step text-white mb-1">Poin b</span>
                                                <h2 class="h6 mt-1">Memilih Produk Pewarnaan yang Aman</h2>
                                                <p class="mb-2">
                                                    Memilih produk pewarna rambut yang aman, bebas bahan kimia keras,
                                                    dan
                                                    <em>hipoalergenik</em> terutama bila pelanggan memiliki kulit
                                                    sensitif atau alergi.
                                                </p>

                                                <p class="tiny-label mb-1">Latihan b – Centang ciri produk yang
                                                    <strong>disarankan</strong>:
                                                </p>
                                                <div id="qb">
                                                    <div class="form-check">
                                                        <input type="checkbox" id="b1" class="form-check-input">
                                                        <label for="b1" class="form-check-label">Label bebas amonia /
                                                            bahan kimia terlalu keras.</label>
                                                    </div>
                                                    <div class="form-check">
                                                        <input type="checkbox" id="b2" class="form-check-input">
                                                        <label for="b2" class="form-check-label">Tertulis hipoalergenik
                                                            atau cocok untuk kulit sensitif.</label>
                                                    </div>
                                                    <div class="form-check">
                                                        <input type="checkbox" id="b3" class="form-check-input">
                                                        <label for="b3" class="form-check-label">Tidak ada informasi
                                                            komposisi sama sekali.</label>
                                                    </div>
                                                </div>
                                                <div id="feedB" class="mt-2 small"></div>
                                                <div class="btn-row">
                                                    <button class="btn btn-outline-brand btn-sm"
                                                        onclick="cekB()">Cek</button>
                                                    <button class="btn btn-outline-secondary btn-sm"
                                                        onclick="resetB()">Reset</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- c. Perawatan rutin -->
                                    <div class="col-12">
                                        <div class="card card-section shadow-sm">
                                            <div class="card-body">
                                                <span class="badge badge-step text-white mb-1">Poin c</span>
                                                <h2 class="h6 mt-1">Perawatan Rambut secara Rutin</h2>
                                                <p class="mb-2">
                                                    Melakukan perawatan rambut secara rutin untuk menjaga kesehatan
                                                    rambut dan kulit kepala
                                                    sebelum melakukan pewarnaan.
                                                </p>

                                                <p class="tiny-label mb-1">Latihan c – Beri contoh singkat perawatan
                                                    yang perlu dilakukan
                                                    (1–2 kata, misal: “hair mask”).</p>
                                                <input type="text" id="qcText"
                                                    class="form-control form-control-sm w-auto"
                                                    placeholder="contoh perawatan">
                                                <div id="feedC" class="mt-2 small"></div>
                                                <div class="btn-row">
                                                    <button class="btn btn-outline-brand btn-sm"
                                                        onclick="cekC()">Cek</button>
                                                    <button class="btn btn-outline-secondary btn-sm"
                                                        onclick="resetC()">Reset</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- d. Mengikuti petunjuk penggunaan -->
                                    <div class="col-12">
                                        <div class="card card-section shadow-sm">
                                            <div class="card-body">
                                                <span class="badge badge-step text-white mb-1">Poin d</span>
                                                <h2 class="h6 mt-1">Mengikuti Petunjuk Penggunaan Produk</h2>
                                                <p class="mb-2">
                                                    Mengikuti petunjuk penggunaan pada produk pewarna rambut. Saat
                                                    aplikasi,
                                                    jangan melebihi waktu yang dianjurkan untuk menghindari iritasi atau
                                                    kerusakan.
                                                </p>

                                                <p class="tiny-label mb-1">
                                                    Latihan d – Jika kemasan menuliskan waktu pemakaian 30 menit,
                                                    mana jawaban paling tepat?
                                                </p>
                                                <select id="qd" class="form-select form-select-sm w-auto">
                                                    <option value="">-- pilih jawaban --</option>
                                                    <option value="lebih">Boleh dibiarkan 45 menit agar warna lebih
                                                        kuat.</option>
                                                    <option value="patuh">Ikuti 30 menit sesuai petunjuk, lalu bilas.
                                                    </option>
                                                    <option value="acak">Bilasan terserah, tidak perlu hitung waktu.
                                                    </option>
                                                </select>
                                                <div id="feedD" class="mt-2 small"></div>
                                                <div class="btn-row">
                                                    <button class="btn btn-outline-brand btn-sm"
                                                        onclick="cekD()">Cek</button>
                                                    <button class="btn btn-outline-secondary btn-sm"
                                                        onclick="resetD()">Reset</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </section>

                            <!-- LATIHAN CEK PEMAHAMAN -->
                            <section id="latihan" class="mb-4">
                                <div class="card shadow-sm border-0">
                                    <div class="card-body">
                                        <h2 class="h6 mb-2">Cek Pemahaman Singkat</h2>
                                        <p class="text-secondary small mb-2">
                                            Centang pernyataan yang menunjukkan <strong>kesiapan</strong> melakukan
                                            pewarnaan single application.
                                        </p>
                                        <div id="rekap">
                                            <div class="form-check">
                                                <input type="checkbox" class="form-check-input" id="r1">
                                                <label for="r1" class="form-check-label">
                                                    Sudah konsultasi dan kondisi kulit kepala dinyatakan sehat.
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input type="checkbox" class="form-check-input" id="r2">
                                                <label for="r2" class="form-check-label">
                                                    Produk yang digunakan sesuai petunjuk dan aman untuk kulit sensitif.
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input type="checkbox" class="form-check-input" id="r3">
                                                <label for="r3" class="form-check-label">
                                                    Waktu aplikasi akan dilebihkan jauh dari saran agar warna lebih
                                                    tahan lama.
                                                </label>
                                            </div>
                                        </div>
                                        <div class="btn-row">
                                            <button class="btn btn-outline-brand btn-sm" onclick="cekRekap()">Cek
                                                Jawaban</button>
                                            <button class="btn btn-outline-secondary btn-sm"
                                                onclick="resetRekap()">Reset</button>
                                        </div>
                                        <div id="feedRekap" class="mt-2 small"></div>
                                    </div>
                                </div>
                            </section>

                            <!-- REFLEKSI -->
                            <section id="refleksi" class="mb-4">
                                <div class="card shadow-sm border-0">
                                    <div class="card-body">
                                        <h2 class="h6 mb-2">Refleksi Singkat</h2>
                                        <p class="text-secondary small">
                                            Dengan bahasamu sendiri, tuliskan mengapa empat poin di atas penting untuk
                                            keamanan pewarnaan rambut.
                                        </p>
                                        <textarea id="refText" class="form-control mb-2" rows="3"
                                            placeholder="Tulis refleksimu di sini..."></textarea>
                                        <div class="btn-row">
                                            <button class="btn btn-outline-brand btn-sm"
                                                onclick="simpanRefleksi()">Simpan Refleksi</button>
                                        </div>
                                        <div id="feedRef" class="mt-2 small text-secondary"></div>
                                    </div>
                                </div>
                            </section>
                        </div>
                    </div>

                    <!-- TOMBOL NAVIGASI DI BAWAH KONTEN -->
                    <div class="page-nav">
                        <div class="page-nav-inner">
                            <a class="btn btn-outline-secondary" href="KontraindikasiPewarnaan.html">
                                <i class="bi bi-arrow-left"></i> Sebelumnya
                            </a>
                            <a class="btn btn-brand" href="AyoLakukanA.html">
                                Berikutnya <i class="bi bi-arrow-right"></i>
                            </a>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </main>

    <!-- FOOTER -->
    <footer class="footer fixed-bottom py-2">
        <div class="container d-flex justify-content-between align-items-center small">
            <span>SMKS ISFI BANJARMASIN • Hair Coloring</span>
            <span class="text-muted">© 2025 • Single Application</span>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        const LS_KEY = 'hal5_singleApplication_state_v1';

        // ====== SIMPAN & MUAT STATE LOCALSTORAGE ======
        function saveState() {
            if (typeof Storage === 'undefined') return;

            const state = {
                qa: document.getElementById('qa').value,
                qb: {
                    b1: document.getElementById('b1').checked,
                    b2: document.getElementById('b2').checked,
                    b3: document.getElementById('b3').checked
                },
                qcText: document.getElementById('qcText').value,
                qd: document.getElementById('qd').value,
                rekap: {
                    r1: document.getElementById('r1').checked,
                    r2: document.getElementById('r2').checked,
                    r3: document.getElementById('r3').checked
                },
                refText: document.getElementById('refText').value,
                feedback: {
                    A: document.getElementById('feedA').innerHTML,
                    B: document.getElementById('feedB').innerHTML,
                    C: document.getElementById('feedC').innerHTML,
                    D: document.getElementById('feedD').innerHTML,
                    rekap: document.getElementById('feedRekap').innerHTML,
                    ref: document.getElementById('feedRef').innerHTML
                }
            };

            localStorage.setItem(LS_KEY, JSON.stringify(state));
        }

        function loadState() {
            if (typeof Storage === 'undefined') return;
            const raw = localStorage.getItem(LS_KEY);
            if (!raw) return;

            let state;
            try { state = JSON.parse(raw); } catch (e) { console.error(e); return; }

            if (!state) return;

            // isian
            document.getElementById('qa').value = state.qa || '';
            document.getElementById('b1').checked = state.qb?.b1 || false;
            document.getElementById('b2').checked = state.qb?.b2 || false;
            document.getElementById('b3').checked = state.qb?.b3 || false;
            document.getElementById('qcText').value = state.qcText || '';
            document.getElementById('qd').value = state.qd || '';

            if (state.rekap) {
                document.getElementById('r1').checked = !!state.rekap.r1;
                document.getElementById('r2').checked = !!state.rekap.r2;
                document.getElementById('r3').checked = !!state.rekap.r3;
            }

            document.getElementById('refText').value = state.refText || '';

            // feedback
            if (state.feedback) {
                if (state.feedback.A) document.getElementById('feedA').innerHTML = state.feedback.A;
                if (state.feedback.B) document.getElementById('feedB').innerHTML = state.feedback.B;
                if (state.feedback.C) document.getElementById('feedC').innerHTML = state.feedback.C;
                if (state.feedback.D) document.getElementById('feedD').innerHTML = state.feedback.D;
                if (state.feedback.rekap) document.getElementById('feedRekap').innerHTML = state.feedback.rekap;
                if (state.feedback.ref) document.getElementById('feedRef').innerHTML = state.feedback.ref;
            }

            if (state.refText) {
                document.getElementById('feedRef').textContent =
                    'Refleksi terakhirmu dimuat dari local storage. Kamu bisa mengeditnya.';
            }
        }

        function resetAll() {
            if (!confirm('Yakin ingin menghapus SEMUA jawaban yang tersimpan di perangkat ini?')) return;

            // reset input
            resetA();
            resetB();
            resetC();
            resetD();
            resetRekap();
            document.getElementById('refText').value = '';
            document.getElementById('feedRef').innerHTML = '';

            if (typeof Storage !== 'undefined') {
                localStorage.removeItem(LS_KEY);
            }
        }

        // ====== INTERAKTIF A–D ======
        function cekA() {
            const v = document.getElementById('qa').value;
            const box = document.getElementById('feedA');
            if (!v) {
                box.textContent = 'Pilih dulu salah satu jawaban.';
                saveState();
                return;
            }
            box.innerHTML = v === 'sebelum'
                ? '<span class="text-success">✅ Benar. Konsultasi dilakukan <strong>sebelum</strong> pewarnaan agar stylist tahu kondisi rambut dan kulit kepala.</span>'
                : '<span class="text-danger">❌ Belum tepat. Konsultasi sebaiknya dilakukan <strong>sebelum</strong> prosedur pewarnaan.</span>';
            saveState();
        }

        function resetA() {
            document.getElementById('qa').value = '';
            document.getElementById('feedA').innerHTML = '';
            saveState();
        }

        function cekB() {
            const b1 = document.getElementById('b1').checked;
            const b2 = document.getElementById('b2').checked;
            const b3 = document.getElementById('b3').checked;
            const box = document.getElementById('feedB');

            if (!b1 && !b2 && !b3) {
                box.textContent = 'Centang dulu minimal satu pilihan.';
                saveState();
                return;
            }

            if (b1 && b2 && !b3) {
                box.innerHTML = '<span class="text-success">✅ Tepat. Produk yang disarankan adalah yang bebas bahan keras dan hipoalergenik; produk tanpa informasi jelas sebaiknya dihindari.</span>';
            } else {
                box.innerHTML = '<span class="text-danger">❌ Masih kurang tepat. Hindari produk yang tidak jelas komposisinya (pilihan ketiga).</span>';
            }
            saveState();
        }

        function resetB() {
            document.getElementById('b1').checked = false;
            document.getElementById('b2').checked = false;
            document.getElementById('b3').checked = false;
            document.getElementById('feedB').innerHTML = '';
            saveState();
        }

        function cekC() {
            const v = (document.getElementById('qcText').value || '').toLowerCase().trim();
            const box = document.getElementById('feedC');
            if (!v) {
                box.textContent = 'Tulis dulu contoh perawatan (misal: creambath, hair mask).';
                saveState();
                return;
            }
            if (v.includes('mask') || v.includes('cream') || v.includes('spa') ||
                v.includes('vitamin') || v.includes('serum') || v.includes('perawatan')) {
                box.innerHTML = '<span class="text-success">✅ Bagus. Perawatan seperti "' + v + '" membantu menjaga rambut sebelum diwarnai.</span>';
            } else {
                box.innerHTML = '<span class="text-warning">ℹ️ Sudah baik. Pastikan contohmu adalah bentuk <strong>perawatan rambut</strong> (creambath, hair mask, hair spa, dll).</span>';
            }
            saveState();
        }

        function resetC() {
            document.getElementById('qcText').value = '';
            document.getElementById('feedC').innerHTML = '';
            saveState();
        }

        function cekD() {
            const v = document.getElementById('qd').value;
            const box = document.getElementById('feedD');
            if (!v) {
                box.textContent = 'Pilih dulu salah satu jawaban.';
                saveState();
                return;
            }
            box.innerHTML = v === 'patuh'
                ? '<span class="text-success">✅ Benar. Waktu aplikasi tidak boleh melebihi anjuran untuk mencegah iritasi atau kerusakan.</span>'
                : '<span class="text-danger">❌ Belum tepat. Ikuti selalu waktu yang tertera pada petunjuk penggunaan.</span>';
            saveState();
        }

        function resetD() {
            document.getElementById('qd').value = '';
            document.getElementById('feedD').innerHTML = '';
            saveState();
        }

        // ====== REKAP ======
        function cekRekap() {
            const r1 = document.getElementById('r1').checked;
            const r2 = document.getElementById('r2').checked;
            const r3 = document.getElementById('r3').checked;
            const box = document.getElementById('feedRekap');

            if (!r1 && !r2 && !r3) {
                box.textContent = 'Centang dulu kondisi yang menurutmu aman.';
                saveState();
                return;
            }

            if (r1 && r2 && !r3) {
                box.innerHTML = '<span class="text-success">✅ Tepat. R1 dan R2 menunjukkan kesiapan, sedangkan R3 justru berisiko karena melebihi waktu anjuran.</span>';
            } else {
                box.innerHTML = '<span class="text-danger">❌ Masih kurang tepat. Ingat, tidak boleh melebihi waktu aplikasi yang dianjurkan.</span>';
            }
            saveState();
        }

        function resetRekap() {
            document.getElementById('r1').checked = false;
            document.getElementById('r2').checked = false;
            document.getElementById('r3').checked = false;
            document.getElementById('feedRekap').innerHTML = '';
            saveState();
        }

        // ====== REFLEKSI ======
        function simpanRefleksi() {
            const txt = document.getElementById('refText').value.trim();
            const box = document.getElementById('feedRef');
            if (!txt) {
                box.textContent = 'Tulis dulu refleksimu, minimal 1 kalimat.';
                saveState();
                return;
            }
            box.textContent = 'Refleksimu tersimpan di perangkat ini (local storage).';
            saveState();
        }

        // INIT
        window.addEventListener('DOMContentLoaded', () => {
            loadState();

            // autosave perubahan sederhana
            ['qa', 'qcText', 'qd', 'b1', 'b2', 'b3', 'r1', 'r2', 'r3', 'qf'].forEach(id => {
                const el = document.getElementById(id);
                if (el) el.addEventListener('change', saveState);
            });
            const ref = document.getElementById('refText');
            if (ref) ref.addEventListener('blur', saveState);
        });
    </script>
</body>

</html>