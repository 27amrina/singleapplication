<!doctype html>
<html lang="id">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Apersepsi • Single Application</title>

    <!-- Bootstrap & Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

    <style>
        :root {
            --navbar-h: 55px;
            --footer-h: 40px;
            --brand: #ff3f8e;
            --sidebar-w: 255px;
            --sidebar-gap: 8px;
            --line: #e5e7eb;
        }

        html,
        body {
            height: 100%;
        }

        body {
            padding-bottom: var(--footer-h);
            background: #fff;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        }

        .main-pad {
            padding-top: var(--navbar-h);
        }

        main.app-shell {
            min-height: calc(100vh - var(--navbar-h) - var(--footer-h));
        }

        .navbar,
        .footer {
            background: #fff;
        }

        .footer {
            border-top: 1px solid #eee;
        }

        .menu-card {
            background: #fff;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, .04);
        }

        .menu-title {
            padding: .75rem 1rem;
            border-bottom: 1px solid #eee;
            font-weight: 600;
        }

        .menu-item {
            display: block;
            padding: .6rem 1rem;
            color: inherit;
            text-decoration: none;
            font-size: .95rem;
        }

        .menu-item:hover {
            background: #fafafa;
        }

        .menu-item.active {
            background: #f5f5f5;
            font-weight: 600;
        }

        .no-top-gap>aside,
        .no-top-gap>section {
            padding-top: 0 !important;
        }

        .btn-brand {
            background: var(--brand);
            color: #fff;
        }

        .btn-brand:hover {
            color: #fff;
            filter: brightness(.95);
        }

        .materi-card .card-header {
            background: #fff;
            border-bottom: 1px solid #eee;
            padding: .5rem 1rem;
        }

        .page-nav {
            margin-top: 1rem;
            margin-bottom: 0.5rem;
        }

        .page-nav-inner {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: .5rem;
            flex-wrap: wrap;
        }

        /* Tombol outline-primary jadi pink */
        .btn-outline-primary {
            color: var(--brand);
            border-color: var(--brand);
        }

        .btn-outline-primary:hover,
        .btn-outline-primary:focus {
            background-color: var(--brand);
            border-color: var(--brand);
            color: #fff;
        }

        /* Mobile: sidebar ikut alur */
        @media (max-width: 767.98px) {
            .sidebar-fixed {
                position: static;
                width: 100%;
            }
        }

        /* Desktop: sidebar fixed kiri, konten bergeser & card dipendekkan */
        @media (min-width: 768px) {
            .sidebar-fixed {
                position: fixed;
                top: var(--navbar-h);
                left: 0;
                width: var(--sidebar-w);
                height: calc(100dvh - var(--navbar-h));
                overflow-y: auto;
            }

            .content-with-fixed {
                margin-left: calc(var(--sidebar-w) + var(--sidebar-gap));
            }

            .materi-card {
                display: flex;
                flex-direction: column;
                max-height: calc(100dvh - var(--navbar-h) - var(--footer-h) - 90px);
            }

            .materi-card .card-body {
                flex: 1 1 auto;
                min-height: 0;
                overflow: auto;
                -webkit-overflow-scrolling: touch;
            }
        }



        .flashcard {
            border: 1px solid var(--line);
            border-radius: 8px;
            padding: .75rem;
            cursor: pointer;
            background: #fff;
            transition: background .15s, box-shadow .15s;
        }

        .flashcard.active {
            background: rgba(255, 63, 142, 0.04);
            box-shadow: 0 0 0 1px rgba(255, 63, 142, 0.25);
        }

        .box {
            fill: #fff;
            stroke: #e5e7eb;
            stroke-width: 2;
            rx: 16;
        }

        .line {
            stroke: var(--brand);
            stroke-width: 3;
        }

        .text {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            font-size: 18px;
        }

        .sticky-top-shadow {
            box-shadow: 0 6px 12px rgba(0, 0, 0, .06);
        }

        .draggable {
            cursor: grab;
        }

        .dropzone {
            min-height: 70px;
            border: 2px dashed #cbd5e1;
            border-radius: .75rem;
            padding: .5rem;
            background: #fff;
        }

        .dropzone.active {
            border-color: #0d6efd;
            background: #eef6ff;
        }

        .dropzone.correct {
            border-color: #198754;
            background: #e8fff1;
        }

        .dropzone.wrong {
            border-color: #dc3545;
            background: #fff1f2;
        }

        /* kartu warna – dipakai baik di pool maupun di dropzone */
        .tone-abu {
            background-color: #4b5563;
            /* abu-abu gelap */
            color: #fff;
        }

        .tone-navy {
            background-color: #1e3a8a;
            /* navy */
            color: #fff;
        }

        .tone-hijau {
            background-color: #15803d;
            /* hijau tua */
            color: #fff;
        }

        .tone-maroon {
            background-color: #7f1d1d;
            /* maroon */
            color: #fff;
        }

        .tone-ash {
            background-color: #9ca3af;
            /* abu ash */
            color: #111827;
        }

        .tone-pastel {
            background-color: #f9a8d4;
            /* pink pastel */
            color: #4b5563;
        }

        .tone-copper {
            background-color: #f97316;
            /* copper / oranye keemasan */
            color: #111827;
        }

        .tone-bronze {
            background-color: #b45309;
            /* bronze coklat keemasan */
            color: #fff;
        }

        .tone-mint {
            background-color: #6ee7b7;
            /* mint */
            color: #065f46;
        }

        .tone-teh {
            background-color: #84cc16;
            /* hijau teh */
            color: #14532d;
        }

        /* kartu warna – dipakai baik di pool maupun di dropzone */
        .tone-abu {
            background-color: #4b5563;
            /* abu-abu gelap */
            color: #fff;
        }

        .tone-navy {
            background-color: #1e3a8a;
            /* navy */
            color: #fff;
        }

        .tone-hijau {
            background-color: #15803d;
            /* hijau tua */
            color: #fff;
        }

        .tone-maroon {
            background-color: #7f1d1d;
            /* maroon */
            color: #fff;
        }

        .tone-ash {
            background-color: #9ca3af;
            /* abu ash */
            color: #111827;
        }

        .tone-pastel {
            background-color: #f9a8d4;
            /* pink pastel */
            color: #4b5563;
        }

        .tone-copper {
            background-color: #f97316;
            /* copper / oranye keemasan */
            color: #111827;
        }

        .tone-bronze {
            background-color: #b45309;
            /* bronze coklat keemasan */
            color: #fff;
        }

        .tone-mint {
            background-color: #6ee7b7;
            /* mint */
            color: #065f46;
        }

        .tone-teh {
            background-color: #84cc16;
            /* hijau teh */
            color: #14532d;
        }
    </style>
</head>

<body>
    <!-- NAVBAR -->
    <nav class="navbar navbar-light navbar-expand-lg fixed-top shadow-sm">
        <div class="container">
            <a class="navbar-brand d-flex align-items-center gap-2" href="../index.html">
                <i class="bi bi-brush" style="font-size:1.25rem; color:var(--brand)"></i>
                <strong>Pewarnaan Rambut</strong> <span class="fw-normal">• Single Application</span>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navs">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navs">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="../index.html">Beranda</a></li>
                    <li class="nav-item"><a class="nav-link active fw-semibold" style="color:var(--brand)"
                            aria-current="page" href="videopengantar.html">Materi</a></li>
                    <li class="nav-item"><a class="nav-link" href="../evaluasi.html">Latihan</a></li>
                    <li class="nav-item"><a class="nav-link" href="../kd.html">Tujuan Pembelajaran</a></li>
                    <li class="nav-item"><a class="nav-link" href="../peta.html">Peta Konsep</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- MAIN: sidebar + konten -->
    <main class="main-pad app-shell">
        <div class="container-fluid">
            <div class="row g-1 no-top-gap">
                <!-- SIDEBAR -->
                <aside class="col-12 col-md-auto order-1 order-md-0 p-0">
                    <nav class="menu-card sidebar-fixed shadow-sm">
                        <div class="menu-title"><i class="bi bi-journal-bookmark"></i> Single Application</div>
                        <a class="menu-item" aria-current="page" href="videopengantar.html">
                            <i class="bi bi-lightbulb">Video Pengantar</i>
                        </a>
                        <a class="menu-item " aria-current="page" href="SingleApplication.html">
                            <i class="bi bi-lightbulb"></i> Overview Single Application
                        </a>

                        <!-- A. Pewarnaan Rambut Single -->
                        <button class="d-flex align-items-center w-100 border-0 bg-transparent menu-item active"
                            type="button" data-bs-toggle="collapse" data-bs-target="#submenu-A" aria-expanded="true"
                            aria-controls="submenu-A">
                            <span class="me-2"><i class="bi bi-droplet-half"></i></span>
                            <span class="flex-grow-1 text-start">A. Pewarnaan Rambut Single</span>
                            <i class="bi bi-chevron-down small"></i>
                        </button>
                        <div class="collapse show" id="submenu-A">
                            <ul class="nav flex-column ps-4 my-1">
                                <li><a class="menu-item py-1" href="PewarnaanSingleApplication.html">1. Pewarnaan Single
                                        Application</a></li>
                                <li><a class="menu-item py-1 active" href="CaraMemilihWarna.html">2. Cara Memilih
                                        Warna</a>
                                </li>
                                <li><a class="menu-item py-1" href="MemilihWarnaCat.html">3. Memilih Warna Cat</a></li>
                                <li><a class="menu-item py-1" href="KontraindikasiPewarnaan.html">4. Kontraindikasi
                                        Pewarnaan</a></li>
                                <li><a class="menu-item py-1" href="HalYangDiperhatikan.html">5. Hal Diperhatikan</a>
                                </li>
                                <li><a class="menu-item py-1" href="AyoLakukanA.html">6. Ayo Lakukan</a></li>
                            </ul>
                        </div>

                        <!-- B. Toning -->
                        <button class="d-flex align-items-center w-100 border-0 bg-transparent menu-item" type="button"
                            data-bs-toggle="collapse" data-bs-target="#submenu-B" aria-expanded="true"
                            aria-controls="submenu-B">
                            <span class="me-2"><i class="bi bi-palette"></i></span>
                            <span class="flex-grow-1 text-start">B. Toning</span>
                            <i class="bi bi-chevron-down small"></i>
                        </button>
                        <div class="collapse show" id="submenu-B">
                            <ul class="nav flex-column ps-4 my-1">
                                <li><a class="menu-item py-1" href="HairToning.html">1. Hair Toning</a></li>
                                <li><a class="menu-item py-1" href="CiriHairToning.html">2. Ciri Hair Toning</a></li>
                                <li><a class="menu-item py-1" href="KeunggulanHairToning.html">3. Keunggulan Hair
                                        Toning</a></li>
                                <li><a class="menu-item py-1" href="KosmetikHairToning.html">4. Kosmetik Hair Toning</a>
                                </li>
                                <li><a class="menu-item py-1" href="ProsedurToning.html">5. Prosedur Melakukan
                                        Toning</a></li>
                                <li><a class="menu-item py-1" href="HalDiperhatikanToning.html">6. Hal Diperhatikan</a>
                                </li>
                                <li><a class="menu-item py-1" href="AyoLakukanB.html">7. Ayo Lakukan</a></li>
                            </ul>
                        </div>

                        <!-- C. Pewarnaan Uban -->
                        <button class="d-flex align-items-center w-100 border-0 bg-transparent menu-item" type="button"
                            data-bs-toggle="collapse" data-bs-target="#submenu-C" aria-expanded="true"
                            aria-controls="submenu-C">
                            <span class="me-2"><i class="bi bi-person-lines-fill"></i></span>
                            <span class="flex-grow-1 text-start">C. Pewarnaan Uban</span>
                            <i class="bi bi-chevron-down small"></i>
                        </button>
                        <div class="collapse show" id="submenu-C">
                            <ul class="nav flex-column ps-4 my-1">
                                <li><a class="menu-item py-1" href="PewarnaanUban.html">1. Pewarnaan Uban</a></li>
                                <li><a class="menu-item py-1" href="JenisPewarnaanUban.html">2. Jenis Pewarnaan</a>
                                </li>
                                <li><a class="menu-item py-1" href="TeknikPewarnaanUban.html">3. Teknik Pewarnaan</a>
                                </li>
                                <li><a class="menu-item py-1" href="UjiTempel.html">4. Uji Tempel</a></li>
                                <li><a class="menu-item py-1" href="ProsedurKerjaUban.html">5. Prosedur Kerja</a></li>
                                <li><a class="menu-item py-1" href="ReaksiAlergiUban.html">6. Reaksi Alergi</a></li>
                                <li><a class="menu-item py-1" href="KesalahanPewarnaanUban.html">7. Kesalahan
                                        Pewarnaan</a></li>
                                <li><a class="menu-item py-1" href="AyoLakukanC.html">8. Ayo Lakukan</a></li>
                            </ul>
                        </div>

                        <!-- Evaluasi -->
                        <a class="menu-item" href="../evaluasi.html">
                            <i class="bi bi-clipboard-check"></i> Evaluasi
                        </a>
                        <a class="menu-item" href="VideoPentup.html">
                            <i class="bi bi-camera-video"></i> Evaluasi
                        </a>
                    </nav>
                </aside>

                <!-- KONTEN KANAN -->
                <section class="col-12 col-md-9 col-xl-10 content-with-fixed order-2 order-md-0">
                    <div class="card shadow-sm materi-card">

                        <div class="card-header d-flex align-items-center gap-2">
                            <i class="bi bi-lightbulb" style="color:var(--brand); font-size:1.25rem;"></i>
                            <h3 class="h5 mb-0 fw-bold">Cara Memilih Pewarna Rambut untuk Teknik Single Application
                            </h3>
                        </div>

                        <div class="card-body" id="apersepsi-hair-coloring">

                            <!-- isi -->
                            <!-- MATERI -->
                            <section id="materi" class="mb-4">
                                <div class="card shadow-sm border-0">
                                    <div class="card-body">

                                        <p>
                                            Pemilihan warna rambut yang sesuai dengan teknik <em>single application</em>
                                            berpengaruh besar pada hasil akhir pewarnaan.
                                            Berikut beberapa prinsip pemilihan warna.
                                        </p>

                                        <h6 class="mt-3">a. Mengenali Warna Kulit</h6>
                                        <p>
                                            Perhatikan warna kulit pelanggan dan undertone-nya: hangat, dingin, atau
                                            netral.
                                            Jika nadi di pergelangan tangan tampak <strong>biru keunguan</strong>,
                                            biasanya menunjukkan <strong>undertone dingin (cool)</strong>.
                                        </p>

                                        <h6 class="mt-3">b. Memilih Warna Berdasarkan Undertone</h6>
                                        <ul>
                                            <li><strong>Undertone dingin (cool)</strong> cocok dengan: abu-abu gelap,
                                                navy, hijau, cokelat, merah maroon, ash, dan pastel.</li>
                                            <li><strong>Undertone hangat (warm)</strong> cocok dengan: copper blonde,
                                                bronze, dan merah maroon.</li>
                                            <li><strong>Undertone netral</strong> bisa memakai warna mint dan hijau teh.
                                            </li>
                                        </ul>
                                        <p class="mb-0">
                                            Jika masih ragu, pelanggan dapat berkonsultasi dengan hairdresser di salon
                                            untuk menentukan warna yang paling sesuai.
                                        </p>
                                    </div>
                                </div>
                            </section>

                            <!-- INTERAKTIF 1 -->
                            <section id="int1" class="mb-4">
                                <div class="card shadow-sm border-0">
                                    <div class="card-body">
                                        <h2 class="h5 mb-2">Latihan 1 – Mengenali Undertone Kulit</h2>
                                        <p class="text-secondary small">Tentukan undertone yang paling tepat untuk tiap
                                            deskripsi.</p>

                                        <div class="mb-3">
                                            <p class="mb-1">1) Nadi tampak biru keunguan, kulit pucat dengan rona
                                                kemerahan.</p>
                                            <div id="u1" data-correct="cool">
                                                <label class="me-3"><input type="radio" name="u1" value="cool"> Dingin
                                                    (cool)</label>
                                                <label class="me-3"><input type="radio" name="u1" value="warm"> Hangat
                                                    (warm)</label>
                                                <label class="me-3"><input type="radio" name="u1" value="neutral">
                                                    Netral</label>
                                            </div>
                                        </div>

                                        <div class="mb-3">
                                            <p class="mb-1">2) Nadi tampak hijau, kulit keemasan, cocok memakai
                                                perhiasan emas.</p>
                                            <div id="u2" data-correct="warm">
                                                <label class="me-3"><input type="radio" name="u2" value="cool"> Dingin
                                                    (cool)</label>
                                                <label class="me-3"><input type="radio" name="u2" value="warm"> Hangat
                                                    (warm)</label>
                                                <label class="me-3"><input type="radio" name="u2" value="neutral">
                                                    Netral</label>
                                            </div>
                                        </div>

                                        <div class="mb-3">
                                            <p class="mb-1">3) Nadi kadang terlihat biru kadang hijau, cocok memakai
                                                perhiasan emas maupun perak.</p>
                                            <div id="u3" data-correct="neutral">
                                                <label class="me-3"><input type="radio" name="u3" value="cool"> Dingin
                                                    (cool)</label>
                                                <label class="me-3"><input type="radio" name="u3" value="warm"> Hangat
                                                    (warm)</label>
                                                <label class="me-3"><input type="radio" name="u3" value="neutral">
                                                    Netral</label>
                                            </div>
                                        </div>

                                        <button class="btn btn-outline-primary" onclick="cekUndertoneSA()">Cek
                                            Jawaban</button>
                                        <button class="btn btn-outline-secondary ms-2"
                                            onclick="resetUndertoneSA()">Reset</button>
                                        <div id="feedUndertoneSA" class="mt-2"></div>
                                    </div>
                                </div>
                            </section>

                            <!-- INTERAKTIF 2 -->
                            <section id="int2" class="mb-4">
                                <div class="card shadow-sm border-0">
                                    <div class="card-body">
                                        <h2 class="h5 mb-2">Latihan 2 – Warna vs Undertone</h2>
                                        <p class="text-secondary small">Seret kartu warna ke kotak undertone yang tepat.
                                        </p>

                                        <div id="colorPoolSA" class="d-flex flex-wrap gap-2 mb-3">
                                            <span class="badge p-2 draggable tone-abu" draggable="true"
                                                data-key="abu">Abu-abu gelap</span>
                                            <span class="badge p-2 draggable tone-navy" draggable="true"
                                                data-key="navy">Navy</span>
                                            <span class="badge p-2 draggable tone-hijau" draggable="true"
                                                data-key="hijau">Hijau</span>
                                            <span class="badge p-2 draggable tone-maroon" draggable="true"
                                                data-key="maroon">Merah maroon</span>
                                            <span class="badge p-2 draggable tone-ash" draggable="true"
                                                data-key="ash">Ash</span>
                                            <span class="badge p-2 draggable tone-pastel" draggable="true"
                                                data-key="pastel">Pastel</span>
                                            <span class="badge p-2 draggable tone-copper" draggable="true"
                                                data-key="copper">Copper blonde</span>
                                            <span class="badge p-2 draggable tone-bronze" draggable="true"
                                                data-key="bronze">Bronze</span>
                                            <span class="badge p-2 draggable tone-mint" draggable="true"
                                                data-key="mint">Mint</span>
                                            <span class="badge p-2 draggable tone-teh" draggable="true"
                                                data-key="teh">Hijau teh</span>
                                        </div>

                                        <div class="row g-3">
                                            <div class="col-md-4">
                                                <h6 class="mb-1">Cool</h6>
                                                <div class="dropzone" data-accept="cool">
                                                    <small class="text-secondary">Untuk undertone dingin</small>
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <h6 class="mb-1">Warm</h6>
                                                <div class="dropzone" data-accept="warm">
                                                    <small class="text-secondary">Untuk undertone hangat</small>
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <h6 class="mb-1">Neutral</h6>
                                                <div class="dropzone" data-accept="neutral">
                                                    <small class="text-secondary">Untuk undertone netral</small>
                                                </div>
                                            </div>
                                        </div>

                                        <button class="btn btn-outline-primary mt-3" onclick="cekDragSA()">Cek Peta
                                            Warna</button>
                                        <button class="btn btn-outline-secondary mt-3 ms-2"
                                            onclick="resetDragSA()">Reset</button>
                                        <div id="feedDragSA" class="mt-2"></div>
                                    </div>
                                </div>
                            </section>

                            <!-- INTERAKTIF 3 -->
                            <section id="int3" class="mb-5">
                                <div class="card shadow-sm border-0">
                                    <div class="card-body">
                                        <h2 class="h5 mb-2">Latihan 3 – Simulasi Pemilihan Warna</h2>
                                        <p class="text-secondary small">Pilih warna yang paling cocok untuk tiap kasus.
                                        </p>

                                        <div class="mb-3">
                                            <p class="mb-1">
                                                1) Klien dengan undertone dingin ingin tampilan elegan dan tidak terlalu
                                                mencolok.
                                            </p>
                                            <select id="k1SA" class="form-select form-select-sm w-auto">
                                                <option value="">-- pilih --</option>
                                                <option value="ash">Ash</option>
                                                <option value="copper">Copper blonde</option>
                                                <option value="mint">Mint</option>
                                            </select>
                                        </div>

                                        <div class="mb-3">
                                            <p class="mb-1">
                                                2) Klien dengan undertone hangat ingin tampilan keemasan yang cerah.
                                            </p>
                                            <select id="k2SA" class="form-select form-select-sm w-auto">
                                                <option value="">-- pilih --</option>
                                                <option value="navy">Navy</option>
                                                <option value="copper">Copper blonde</option>
                                                <option value="mint">Mint</option>
                                            </select>
                                        </div>

                                        <div class="mb-3">
                                            <p class="mb-1">
                                                3) Klien dengan undertone netral ingin warna segar namun tetap lembut.
                                            </p>
                                            <select id="k3SA" class="form-select form-select-sm w-auto">
                                                <option value="">-- pilih --</option>
                                                <option value="bronze">Bronze</option>
                                                <option value="mint">Mint / hijau teh</option>
                                                <option value="maroon">Merah maroon pekat</option>
                                            </select>
                                        </div>

                                        <button class="btn btn-outline-primary" onclick="cekKasusSA()">Cek
                                            Jawaban</button>
                                        <button class="btn btn-outline-secondary ms-2"
                                            onclick="resetKasusSA()">Reset</button>
                                        <div id="feedKasusSA" class="mt-2"></div>
                                    </div>
                                </div>
                            </section>
                        </div>
                    </div>



                    <!-- TOMBOL NAVIGASI DI BAWAH KONTEN -->
                    <div class="page-nav">
                        <div class="page-nav-inner">
                            <a class="btn btn-outline-secondary" href="PewarnaanSingleApplication.html">
                                <i class="bi bi-arrow-left"></i> Sebelumnya
                            </a>
                            <a class="btn btn-brand" href="MemilihWarnaCat.html">
                                Berikutnya <i class="bi bi-arrow-right"></i>
                            </a>
                        </div>
                    </div>


                </section>
            </div>
        </div>
    </main>

    <!-- FOOTER -->
    <footer class="footer fixed-bottom py-2">
        <div class="container d-flex justify-content-between align-items-center small">
            <span>SMKS ISFI BANJARMASIN • Hair Coloring</span>
            <span class="text-muted">© 2025 • Single Application</span>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // ====== LOCAL STORAGE ======
        const LS_KEY = 'interaktif_cara_memilih_warna_v1';

        function loadState() {
            try {
                const raw = localStorage.getItem(LS_KEY);
                return raw ? JSON.parse(raw) : {};
            } catch (e) {
                console.warn('Gagal membaca localStorage', e);
                return {};
            }
        }

        function saveState(newPartial) {
            try {
                const current = loadState();
                const next = Object.assign({}, current, newPartial);
                localStorage.setItem(LS_KEY, JSON.stringify(next));
            } catch (e) {
                console.warn('Gagal menyimpan ke localStorage', e);
            }
        }

        // ===========================
        // LATIHAN 1 – UNDERTONE (u1,u2,u3)
        // ===========================
        function cekUndertoneSA() {
            const ids = ['u1', 'u2', 'u3'];
            let total = ids.length;
            let benar = 0;
            let belumIsi = false;

            const answers = {};

            ids.forEach(id => {
                const wrapper = document.getElementById(id);
                const correct = wrapper.dataset.correct;
                const picked = wrapper.querySelector('input[type="radio"]:checked');
                if (!picked) {
                    belumIsi = true;
                    return;
                }
                const val = picked.value;
                answers[id] = val;
                if (val === correct) benar++;
            });

            const feed = document.getElementById('feedUndertoneSA');
            let html = '';

            if (belumIsi) {
                html = '<div class="alert alert-info">Lengkapi dulu semua nomor 1–3.</div>';
            } else if (benar === total) {
                html = '<div class="alert alert-success">✅ Tepat! Kamu sudah bisa mengenali undertone dingin, hangat, dan netral.</div>';
            } else {
                html = '<div class="alert alert-warning">⚠️ Skor kamu ' + benar + '/' + total +
                    '. Coba perhatikan kembali ciri nadi dan kecocokan perhiasan.</div>';
            }
            feed.innerHTML = html;

            // simpan state
            saveState({
                latihan1: {
                    answers,
                    feedbackHTML: html
                }
            });
        }

        function resetUndertoneSA() {
            if (!confirm('Yakin menghapus jawaban Latihan 1?')) return;
            ['u1', 'u2', 'u3'].forEach(id => {
                const wrapper = document.getElementById(id);
                wrapper.querySelectorAll('input[type="radio"]').forEach(r => r.checked = false);
            });
            document.getElementById('feedUndertoneSA').innerHTML = '';
            const state = loadState();
            state.latihan1 = { answers: {}, feedbackHTML: '' };
            saveState(state);
        }

        // ===========================
        // LATIHAN 2 – DRAG & DROP WARNA (colorPoolSA + dropzone)
        // ===========================
        // mapping warna -> undertone yang benar
        const colorMapping = {
            abu: 'cool',
            navy: 'cool',
            hijau: 'cool',
            ash: 'cool',
            pastel: 'cool',
            copper: 'warm',
            bronze: 'warm',
            maroon: 'warm',   // di sini dianggap warm
            mint: 'neutral',
            teh: 'neutral'
        };

        const colorPool = document.getElementById('colorPoolSA');
        const originalPoolHTML = colorPool ? colorPool.innerHTML : '';

        function snapshotDragState(zoneStatus = null, feedbackHTML = null) {
            const zones = {
                pool: [],
                cool: [],
                warm: [],
                neutral: []
            };

            // posisi chip di pool
            document.querySelectorAll('#colorPoolSA .draggable').forEach(chip => {
                zones.pool.push(chip.dataset.key);
            });

            // posisi chip di tiap dropzone
            document.querySelectorAll('#int2 .dropzone').forEach(zone => {
                const accept = zone.dataset.accept;
                const chips = zone.querySelectorAll('.draggable');
                chips.forEach(chip => {
                    zones[accept].push(chip.dataset.key);
                });
            });

            const storedStatus = {};
            document.querySelectorAll('#int2 .dropzone').forEach(zone => {
                const name = zone.dataset.accept;
                storedStatus[name] = {
                    correct: zone.classList.contains('correct'),
                    wrong: zone.classList.contains('wrong')
                };
            });

            saveState({
                latihan2: {
                    zones,
                    zoneStatus: zoneStatus || storedStatus,
                    feedbackHTML: feedbackHTML !== null ? feedbackHTML : (loadState().latihan2 || {}).feedbackHTML || ''
                }
            });
        }

        function initDragSA() {
            // dragstart di semua chip
            document.querySelectorAll('#int2 .draggable').forEach(el => {
                el.addEventListener('dragstart', e => {
                    e.dataTransfer.setData('text/plain', e.target.dataset.key);
                    e.dataTransfer.effectAllowed = 'move';
                });
            });

            // dropzone (cool, warm, neutral)
            document.querySelectorAll('#int2 .dropzone').forEach(zone => {
                zone.addEventListener('dragover', e => {
                    e.preventDefault();
                    zone.classList.add('active');
                });
                zone.addEventListener('dragleave', () => zone.classList.remove('active'));
                zone.addEventListener('drop', e => {
                    e.preventDefault();
                    zone.classList.remove('active');
                    const key = e.dataTransfer.getData('text/plain');
                    const chip = document.querySelector('#int2 .draggable[data-key="' + key + '"]');
                    if (!chip) return;

                    const sm = zone.querySelector('small');
                    if (sm) sm.remove();

                    zone.appendChild(chip);

                    // hapus status benar/salah karena posisi berubah
                    document.querySelectorAll('#int2 .dropzone').forEach(z => {
                        z.classList.remove('correct', 'wrong');
                    });
                    document.getElementById('feedDragSA').innerHTML = '';

                    snapshotDragState();
                });
            });

            // jadikan colorPoolSA juga tempat drop (kembalikan ke pool)
            if (colorPool) {
                colorPool.addEventListener('dragover', e => {
                    e.preventDefault();
                });
                colorPool.addEventListener('drop', e => {
                    e.preventDefault();
                    const key = e.dataTransfer.getData('text/plain');
                    const chip = document.querySelector('#int2 .draggable[data-key="' + key + '"]');
                    if (!chip) return;
                    colorPool.appendChild(chip);

                    document.querySelectorAll('#int2 .dropzone').forEach(z => {
                        z.classList.remove('correct', 'wrong');
                    });
                    document.getElementById('feedDragSA').innerHTML = '';

                    snapshotDragState();
                });
            }
        }

        function cekDragSA() {
            const zones = document.querySelectorAll('#int2 .dropzone');
            const feed = document.getElementById('feedDragSA');

            let benarZona = 0;
            let totalZona = zones.length;

            zones.forEach(zone => {
                zone.classList.remove('correct', 'wrong');
                const target = zone.dataset.accept;
                const chips = zone.querySelectorAll('.draggable');

                if (chips.length === 0) {
                    zone.classList.add('wrong');
                    return;
                }

                let ok = true;
                chips.forEach(chip => {
                    const key = chip.dataset.key;
                    if (colorMapping[key] !== target) ok = false;
                });

                if (ok) {
                    zone.classList.add('correct');
                    benarZona++;
                } else {
                    zone.classList.add('wrong');
                }
            });

            let html = '';
            if (benarZona === totalZona) {
                html = '<div class="alert alert-success">✅ Mantap! Semua warna sudah kamu letakkan pada undertone yang tepat.</div>';
            } else {
                html = '<div class="alert alert-warning">⚠️ Masih ada warna yang belum tepat. Ingat: cool cenderung ke abu/navy/ash, warm ke copper/bronze/maroon, neutral ke mint dan hijau teh.</div>';
            }
            feed.innerHTML = html;

            // simpan state lengkap (posisi + status)
            const zoneStatus = {};
            zones.forEach(zone => {
                const name = zone.dataset.accept;
                zoneStatus[name] = {
                    correct: zone.classList.contains('correct'),
                    wrong: zone.classList.contains('wrong')
                };
            });
            snapshotDragState(zoneStatus, html);
        }

        function resetDragSA() {
            if (!confirm('Yakin menghapus jawaban Latihan 2 (drag & drop)?')) return;

            // reset semua zona
            document.querySelectorAll('#int2 .dropzone').forEach(zone => {
                zone.classList.remove('correct', 'wrong', 'active');
                zone.innerHTML = '<small class="text-secondary">Untuk undertone ' + zone.dataset.accept + '</small>';
            });

            // kembalikan chip ke pool
            if (colorPool) {
                colorPool.innerHTML = originalPoolHTML;
            }

            // feedback kosong
            document.getElementById('feedDragSA').innerHTML = '';

            // re-bind event drag
            initDragSA();

            // simpan state kosong
            const state = loadState();
            state.latihan2 = {
                zones: { pool: [], cool: [], warm: [], neutral: [] },
                zoneStatus: {},
                feedbackHTML: ''
            };
            saveState(state);
        }

        // ===========================
        // LATIHAN 3 – KASUS PEMILIHAN WARNA (k1SA,k2SA,k3SA)
        // ===========================
        function cekKasusSA() {
            const k1 = document.getElementById('k1SA').value;
            const k2 = document.getElementById('k2SA').value;
            const k3 = document.getElementById('k3SA').value;

            const feed = document.getElementById('feedKasusSA');
            if (!k1 || !k2 || !k3) {
                feed.innerHTML = '<div class="alert alert-info">Lengkapi dulu semua kasus 1–3.</div>';
                saveState({
                    latihan3: { k1, k2, k3, feedbackHTML: feed.innerHTML }
                });
                return;
            }

            let benar = 0;
            if (k1 === 'ash') benar++;
            if (k2 === 'copper') benar++;
            if (k3 === 'mint') benar++;

            let html = '';
            if (benar === 3) {
                html = '<div class="alert alert-success">✅ Bagus! Pilihan warnamu sudah cocok dengan undertone dan tujuan tampilan tiap klien.</div>';
            } else {
                html = '<div class="alert alert-warning">⚠️ Skor kamu ' + benar + '/3. Coba sesuaikan lagi: undertone dingin → ash, hangat → copper, netral → mint/hijau teh.</div>';
            }
            feed.innerHTML = html;

            saveState({
                latihan3: { k1, k2, k3, feedbackHTML: html }
            });
        }

        function resetKasusSA() {
            if (!confirm('Yakin menghapus jawaban Latihan 3?')) return;
            document.getElementById('k1SA').value = '';
            document.getElementById('k2SA').value = '';
            document.getElementById('k3SA').value = '';
            document.getElementById('feedKasusSA').innerHTML = '';

            const state = loadState();
            state.latihan3 = { k1: '', k2: '', k3: '', feedbackHTML: '' };
            saveState(state);
        }

        // ===========================
        // RESTORE STATE SAAT HALAMAN DIBUKA
        // ===========================
        document.addEventListener('DOMContentLoaded', function () {
            const state = loadState();

            // --- Latihan 1 ---
            if (state.latihan1 && state.latihan1.answers) {
                const answers = state.latihan1.answers;
                Object.keys(answers).forEach(id => {
                    const val = answers[id];
                    const wrapper = document.getElementById(id);
                    if (!wrapper) return;
                    const radio = wrapper.querySelector('input[type="radio"][value="' + val + '"]');
                    if (radio) radio.checked = true;
                });
                if (state.latihan1.feedbackHTML) {
                    document.getElementById('feedUndertoneSA').innerHTML = state.latihan1.feedbackHTML;
                }
            }

            // --- Latihan 2 ---
            // selalu reset pool ke awal dulu
            if (colorPool) {
                colorPool.innerHTML = originalPoolHTML;
            }
            // pasang event drag
            initDragSA();

            if (state.latihan2 && state.latihan2.zones) {
                const zones = state.latihan2.zones;

                // pastikan semua chip kembali ke pool sebelum diatur ulang posisinya
                // (sudah di-set dengan originalPoolHTML di atas)
                // lalu pindahkan sesuai state
                ['cool', 'warm', 'neutral'].forEach(name => {
                    const zone = document.querySelector('#int2 .dropzone[data-accept="' + name + '"]');
                    if (!zone) return;
                    const keys = zones[name] || [];
                    if (keys.length) {
                        const sm = zone.querySelector('small');
                        if (sm) sm.remove();
                    }
                    keys.forEach(key => {
                        const chip = document.querySelector('#colorPoolSA .draggable[data-key="' + key + '"]');
                        if (chip) zone.appendChild(chip);
                    });
                });

                // hapus dulu status correct/wrong
                document.querySelectorAll('#int2 .dropzone').forEach(z => {
                    z.classList.remove('correct', 'wrong', 'active');
                });

                // pulihkan status benar/salah kalau ada
                if (state.latihan2.zoneStatus) {
                    Object.keys(state.latihan2.zoneStatus).forEach(name => {
                        const zone = document.querySelector('#int2 .dropzone[data-accept="' + name + '"]');
                        if (!zone) return;
                        const st = state.latihan2.zoneStatus[name];
                        if (st.correct) zone.classList.add('correct');
                        if (st.wrong) zone.classList.add('wrong');
                    });
                }

                if (state.latihan2.feedbackHTML) {
                    document.getElementById('feedDragSA').innerHTML = state.latihan2.feedbackHTML;
                }
            }

            // setelah memindahkan chip, kita perlu pastikan event drag masih terpasang
            initDragSA();

            // --- Latihan 3 ---
            if (state.latihan3) {
                if (typeof state.latihan3.k1 === 'string') document.getElementById('k1SA').value = state.latihan3.k1;
                if (typeof state.latihan3.k2 === 'string') document.getElementById('k2SA').value = state.latihan3.k2;
                if (typeof state.latihan3.k3 === 'string') document.getElementById('k3SA').value = state.latihan3.k3;
                if (state.latihan3.feedbackHTML) {
                    document.getElementById('feedKasusSA').innerHTML = state.latihan3.feedbackHTML;
                }
            }
        });
    </script>

</body>

</html>